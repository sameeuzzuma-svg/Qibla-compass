<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Islamic Prayer Times - Find Namaz Timings & Nearby Mosques</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts - Islamic Style -->
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Leaflet CSS for Maps -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        /* Islamic Prayer Times App - Custom Styles */
        :root {
            --islamic-green: #2d5a3d;
            --islamic-green-light: #4a8061;
            --islamic-gold: #d4af37;
            --islamic-gold-light: #f4d03f;
            --text-dark: #2c3e50;
            --text-light: #ecf0f1;
            --shadow-light: rgba(0, 0, 0, 0.1);
            --shadow-medium: rgba(0, 0, 0, 0.15);
            --gradient-green: linear-gradient(135deg, var(--islamic-green), var(--islamic-green-light));
            --gradient-gold: linear-gradient(135deg, var(--islamic-gold), var(--islamic-gold-light));
        }
        /* Base Styles */
        body {
            font-family: 'Roboto', sans-serif;
            line-height: 1.6;
            color: var(--text-dark);
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding-top: 120px;
        }
        .arabic-font {
            font-family: 'Amiri', serif;
            font-weight: 700;
        }
        /* Navigation */
        .bg-islamic-green {
            background: var(--gradient-green) !important;
            box-shadow: 0 2px 20px var(--shadow-medium);
        }
        .navbar-brand {
            font-size: 1.5rem;
            font-weight: 700;
        }
        .navbar-nav .nav-link {
            font-weight: 500;
            margin: 0 0.5rem;
            transition: all 0.3s ease;
            border-radius: 25px;
            padding: 0.5rem 1rem !important;
        }
        .navbar-nav .nav-link:hover,
        .navbar-nav .nav-link.active {
            background-color: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }
        /* Main Content */
        .main-content {
            margin-top: 44px;
        }
        .section {
            display: none;
            padding: 3rem 0;
            min-height: 70vh;
            animation: fadeIn 0.5s ease-in-out;
        }
        .section.active {
            display: block;
        }
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .section-header {
            margin-bottom: 3rem;
        }
        .section-header h2 {
            color: var(--islamic-green);
            font-weight: 700;
            margin-bottom: 1rem;
        }
        /* Islamic Welcome */
        .islamic-welcome {
            background: white;
            padding: 3rem;
            border-radius: 20px;
            box-shadow: 0 10px 30px var(--shadow-light);
            margin-bottom: 2rem;
        }
        .islamic-welcome h1 {
            color: var(--islamic-green);
            font-size: 2rem;
            margin-bottom: 1rem;
        }
        .islamic-welcome h2 {
            color: var(--islamic-green);
            font-weight: 700;
        }
        /* Location Card */
        .location-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 8px 25px var(--shadow-light);
            transition: transform 0.3s ease;
        }
        .location-card:hover {
            transform: translateY(-5px);
        }
        .location-card .card-header {
            background: var(--gradient-green);
            color: white;
            font-weight: 600;
            padding: 1rem 1.5rem;
            border: none;
        }
        .location-card .card-body {
            padding: 1.5rem;
        }
        /* Prayer Time Cards */
        .prayer-card {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            text-align: center;
            box-shadow: 0 8px 25px var(--shadow-light);
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        .prayer-card:hover {
            transform: translateY(-5px);
            border-color: var(--islamic-gold);
            box-shadow: 0 15px 35px var(--shadow-medium);
        }
        .prayer-card .prayer-icon {
            font-size: 2.5rem;
            color: var(--islamic-green);
            margin-bottom: 1rem;
        }
        .prayer-card .prayer-name {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--islamic-green);
            margin-bottom: 0.5rem;
        }
        .prayer-card .prayer-time {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--islamic-gold);
            font-family: 'Roboto', monospace;
        }
        .prayer-card.current-prayer {
            background: var(--gradient-green);
            color: white;
        }
        .prayer-card.current-prayer .prayer-icon,
        .prayer-card.current-prayer .prayer-name {
            color: white;
        }
        .prayer-card.current-prayer .prayer-time {
            color: var(--islamic-gold-light);
        }
        /* Next Prayer Countdown */
        .next-prayer-countdown {
            background: var(--gradient-gold);
            padding: 1.5rem;
            border-radius: 20px;
            color: white;
            text-align: center;
            margin-bottom: 2rem;
            box-shadow: 0 10px 30px var(--shadow-light);
        }
        .countdown-time {
            font-size: 2.5rem;
            font-weight: 700;
            font-family: 'Roboto', monospace;
            margin: 1rem 0;
        }
        /* Qibla Compass */
        .qibla-compass {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            text-align: center;
            box-shadow: 0 10px 30px var(--shadow-light);
        }
        .compass-circle {
            width: 200px;
            height: 200px;
            border: 3px solid var(--islamic-green);
            border-radius: 50%;
            margin: 1rem auto;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
        }
        .qibla-arrow {
            font-size: 3rem;
            color: var(--islamic-gold);
            transition: transform 0.3s ease;
        }
        /* Dhikr Counter */
        .dhikr-counter {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            text-align: center;
            box-shadow: 0 10px 30px var(--shadow-light);
        }
        .dhikr-count {
            font-size: 4rem;
            font-weight: 700;
            color: var(--islamic-gold);
            margin: 1rem 0;
        }
        .dhikr-button {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: var(--gradient-green);
            border: none;
            color: white;
            font-size: 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 1rem auto;
        }
        .dhikr-button:hover {
            transform: scale(1.1);
            box-shadow: 0 10px 30px var(--shadow-medium);
        }
        /* Map Container */
        .map-container {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 8px 25px var(--shadow-light);
            height: 500px;
            position: relative;
        }
        #mosque-map {
            height: 100%;
            width: 100%;
        }
        /* Mosque List Items */
        .mosque-item {
            background: white;
            border-radius: 10px;
            padding: 1rem;
            box-shadow: 0 4px 15px var(--shadow-light);
            transition: transform 0.3s ease;
            cursor: pointer;
            margin-bottom: 1rem;
        }
        .mosque-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px var(--shadow-medium);
        }
        .mosque-name {
            font-weight: 600;
            color: var(--islamic-green);
            margin-bottom: 0.5rem;
        }
        .mosque-address {
            color: #6c757d;
            font-size: 0.9rem;
        }
        .mosque-distance {
            color: var(--islamic-gold);
            font-weight: 600;
            font-size: 0.9rem;
        }
        .distance-badge {
            background: var(--islamic-gold);
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        /* Cards */
        .card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 8px 25px var(--shadow-light);
            transition: transform 0.3s ease;
        }
        .card:hover {
            transform: translateY(-5px);
        }
        .card-header {
            background: var(--gradient-green);
            color: white;
            border: none;
            font-weight: 600;
        }
        /* Alerts */
        .alert {
            border: none;
            border-radius: 10px;
            box-shadow: 0 4px 15px var(--shadow-light);
        }
        /* Loading Spinners */
        .spinner-border {
            color: var(--islamic-green) !important;
        }
        /* Buttons */
        .btn-primary {
            background: var(--gradient-green);
            border: none;
            border-radius: 25px;
            padding: 0.75rem 2rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            background: var(--gradient-gold);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px var(--shadow-medium);
        }
        .btn-gold {
            background: var(--gradient-gold);
            border: none;
            border-radius: 25px;
            padding: 0.75rem 2rem;
            font-weight: 600;
            color: white;
            transition: all 0.3s ease;
        }
        .btn-gold:hover {
            background: var(--gradient-green);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px var(--shadow-medium);
            color: white;
        }
        /* Tool Cards */
        .tool-card {
            background: white;
            border-radius: 20px;
            padding: 2rem 1.5rem;
            text-align: center;
            box-shadow: 0 10px 30px var(--shadow-light);
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid transparent;
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        .tool-card:hover {
            transform: translateY(-10px);
            border-color: var(--islamic-gold);
            box-shadow: 0 20px 40px var(--shadow-medium);
        }
        .tool-icon {
            font-size: 3rem;
            color: var(--islamic-green);
            margin-bottom: 1.5rem;
        }
        .tool-title {
            color: var(--islamic-green);
            font-weight: 700;
            margin-bottom: 1rem;
            font-size: 1.3rem;
        }
        .tool-description {
            color: #6c757d;
            margin-bottom: 2rem;
            flex-grow: 1;
        }
        .tool-button {
            color: var(--islamic-gold);
            font-size: 1.5rem;
            transition: all 0.3s ease;
        }
        .tool-card:hover .tool-button {
            transform: translateX(5px);
        }
        /* Islamic Calendar */
        .islamic-date {
            background: var(--gradient-green);
            color: white;
            padding: 1rem;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 1rem;
        }
        /* Filter Controls */
        .filter-controls {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 8px 25px var(--shadow-light);
        }
        /* Footer */
        footer {
            background: var(--gradient-green) !important;
            margin-top: 3rem;
        }
        .footer-links a {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            transition: color 0.3s ease;
            margin: 0 10px;
            font-size: 0.9rem;
        }
        .footer-links a:hover {
            color: white;
            text-decoration: underline;
        }
        /* Responsive Design */
        @media (max-width: 768px) {
            body {
                padding-top: 140px;
            }
            
            .main-content {
                margin-top: 20px;
            }
            
            .islamic-welcome {
                padding: 2rem;
            }
            
            .islamic-welcome h1 {
                font-size: 1.5rem;
            }
            
            .prayer-card {
                margin-bottom: 1rem;
            }
            
            .section {
                padding: 2rem 0;
            }
            
            .map-container {
                height: 400px;
            }
            .footer-links {
                text-align: center;
                margin-top: 1rem;
            }
            .footer-links a {
                display: inline-block;
                margin: 5px;
            }
            .countdown-time {
                font-size: 2rem;
            }
            .compass-circle {
                width: 150px;
                height: 150px;
            }
            .qibla-arrow {
                font-size: 2rem;
            }
        }
        @media (max-width: 480px) {
            .islamic-welcome h1 {
                font-size: 1.2rem;
            }
            
            .islamic-welcome h2 {
                font-size: 1.3rem;
            }
            
            .prayer-card .prayer-icon {
                font-size: 2rem;
            }
            
            .prayer-card .prayer-name {
                font-size: 1rem;
            }
            
            .prayer-card .prayer-time {
                font-size: 1.2rem;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-islamic-green fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="#landing">
                <i class="fas fa-mosque me-2"></i>
                Islamic Prayer Times
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="#landing" data-section="landing">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#prayer-times" data-section="prayer-times">Prayer Times</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#mosque-finder" data-section="mosque-finder">Mosque Finder</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#qibla" data-section="qibla">Qibla Finder</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#dhikr" data-section="dhikr">Dhikr Counter</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#about" data-section="about">About</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Landing Page Section -->
        <section id="landing" class="section active">
            <div class="container">
                <div class="row justify-content-center text-center mb-5">
                    <div class="col-lg-10">
                        <div class="islamic-welcome">
                            <h1 class="arabic-font mb-3">بِسْمِ اللَّهِ الرَّحْمَنِ الرَّحِيم</h1>
                            <h2 class="mb-4">Islamic Prayer Times & Mosque Finder</h2>
                            <p class="lead">Your complete Islamic companion for prayer times, mosque locations, Qibla direction, and spiritual tools. Stay connected with your faith wherever you are.</p>
                        </div>
                    </div>
                </div>

                <!-- Next Prayer Countdown -->
                <div id="next-prayer-section" class="next-prayer-countdown d-none">
                    <h4><i class="fas fa-clock me-2"></i>Next Prayer</h4>
                    <div id="next-prayer-name">Maghrib</div>
                    <div class="countdown-time" id="countdown-timer">02:34:15</div>
                    <p class="mb-0">Time remaining</p>
                </div>

                <!-- Islamic Date -->
                <div class="islamic-date d-none" id="islamic-date">
                    <h6 class="mb-1">Today's Islamic Date</h6>
                    <div id="hijri-date">Loading...</div>
                </div>

                <!-- Tools Grid -->
                <div class="row g-4">
                    <div class="col-md-6 col-lg-3">
                        <div class="tool-card" data-section="prayer-times">
                            <div class="tool-icon">
                                <i class="fas fa-pray"></i>
                            </div>
                            <h4 class="tool-title">Prayer Times</h4>
                            <p class="tool-description">Get accurate Namaz timings with countdown and notifications</p>
                            <div class="tool-button">
                                <i class="fas fa-arrow-right"></i>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6 col-lg-3">
                        <div class="tool-card" data-section="mosque-finder">
                            <div class="tool-icon">
                                <i class="fas fa-mosque"></i>
                            </div>
                            <h4 class="tool-title">Mosque Finder</h4>
                            <p class="tool-description">Find nearby mosques sorted by distance with directions</p>
                            <div class="tool-button">
                                <i class="fas fa-arrow-right"></i>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6 col-lg-3">
                        <div class="tool-card" data-section="qibla">
                            <div class="tool-icon">
                                <i class="fas fa-compass"></i>
                            </div>
                            <h4 class="tool-title">Qibla Finder</h4>
                            <p class="tool-description">Find accurate direction to Mecca with compass</p>
                            <div class="tool-button">
                                <i class="fas fa-arrow-right"></i>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6 col-lg-3">
                        <div class="tool-card" data-section="dhikr">
                            <div class="tool-icon">
                                <i class="fas fa-hands"></i>
                            </div>
                            <h4 class="tool-title">Dhikr Counter</h4>
                            <p class="tool-description">Digital Tasbih counter for your daily dhikr</p>
                            <div class="tool-button">
                                <i class="fas fa-arrow-right"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Prayer Times Section -->
        <section id="prayer-times" class="section">
            <div class="container">
                <div class="section-header text-center">
                    <h2><i class="fas fa-pray me-3"></i>Prayer Times</h2>
                    <p class="lead">Accurate Namaz timings with advanced features</p>
                </div>

                <!-- Location Loading -->
                <div id="prayer-loading" class="text-center mb-4">
                    <div class="spinner-border" role="status">
                        <span class="visually-hidden">Loading prayer times...</span>
                    </div>
                    <p class="mt-2">Loading prayer times for your location...</p>
                </div>

                <!-- Location Error -->
                <div id="prayer-error" class="alert alert-warning text-center d-none" role="alert">
                    <h5 class="alert-heading"><i class="fas fa-exclamation-triangle me-2"></i>Unable to get your location</h5>
                    <p class="mb-0">Please allow location access to view accurate prayer times for your area.</p>
                </div>

                <!-- Prayer Calculation Method -->
                <div id="calculation-method" class="card mb-4 d-none">
                    <div class="card-header">
                        <i class="fas fa-calculator me-2"></i>Calculation Method
                    </div>
                    <div class="card-body">
                        <select class="form-select" id="methodSelect">
                            <option value="2">Islamic Society of North America (ISNA)</option>
                            <option value="1">University of Islamic Sciences, Karachi</option>
                            <option value="3">Muslim World League</option>
                            <option value="4">Umm Al-Qura University, Makkah</option>
                            <option value="5">Egyptian General Authority of Survey</option>
                        </select>
                    </div>
                </div>

                <!-- Location Card -->
                <div id="prayer-location-card" class="location-card mb-4 d-none">
                    <div class="card-header">
                        <i class="fas fa-map-marker-alt me-2"></i>Current Location
                    </div>
                    <div class="card-body">
                        <p class="mb-0">
                            <strong id="prayer-city">Loading...</strong>, 
                            <span id="prayer-country">Loading...</span>
                        </p>
                        <small class="text-muted">
                            Coordinates: <span id="prayer-coordinates">---, ---</span>
                        </small>
                    </div>
                </div>

                <!-- Time Format Toggle -->
                <div id="prayer-format-toggle" class="text-center mb-4 d-none">
                    <div class="form-check form-switch d-inline-block">
                        <input class="form-check-input" type="checkbox" id="timeFormatSwitch" checked>
                        <label class="form-check-label" for="timeFormatSwitch">
                            <span id="timeFormatLabel">24-hour format</span>
                        </label>
                    </div>
                </div>

                <!-- Prayer Times Grid -->
                <div id="prayer-times-grid" class="row g-4 d-none">
                    <div class="col-lg-4 col-md-6">
                        <div class="prayer-card" id="fajr-card">
                            <div class="prayer-icon">
                                <i class="fas fa-sun"></i>
                            </div>
                            <div class="prayer-name">Fajr</div>
                            <div class="prayer-time" id="fajr-time">--:--</div>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-6">
                        <div class="prayer-card" id="dhuhr-card">
                            <div class="prayer-icon">
                                <i class="fas fa-sun"></i>
                            </div>
                            <div class="prayer-name">Dhuhr</div>
                            <div class="prayer-time" id="dhuhr-time">--:--</div>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-6">
                        <div class="prayer-card" id="asr-card">
                            <div class="prayer-icon">
                                <i class="fas fa-cloud-sun"></i>
                            </div>
                            <div class="prayer-name">Asr</div>
                            <div class="prayer-time" id="asr-time">--:--</div>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-6">
                        <div class="prayer-card" id="maghrib-card">
                            <div class="prayer-icon">
                                <i class="fas fa-moon"></i>
                            </div>
                            <div class="prayer-name">Maghrib</div>
                            <div class="prayer-time" id="maghrib-time">--:--</div>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-6">
                        <div class="prayer-card" id="isha-card">
                            <div class="prayer-icon">
                                <i class="fas fa-star"></i>
                            </div>
                            <div class="prayer-name">Isha</div>
                            <div class="prayer-time" id="isha-time">--:--</div>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-6">
                        <div class="prayer-card" id="sunrise-card">
                            <div class="prayer-icon">
                                <i class="fas fa-sun"></i>
                            </div>
                            <div class="prayer-name">Sunrise</div>
                            <div class="prayer-time" id="sunrise-time">--:--</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Mosque Finder Section -->
        <section id="mosque-finder" class="section">
            <div class="container">
                <div class="section-header text-center">
                    <h2><i class="fas fa-mosque me-3"></i>Mosque Finder</h2>
                    <p class="lead">Find nearby mosques with directions and details</p>
                </div>

                <!-- Map and Mosque List -->
                <div class="row">
                    <div class="col-lg-8 mb-4">
                        <div class="map-container">
                            <div id="mosque-map"></div>
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <!-- Location Loading -->
                        <div id="mosque-loading" class="text-center mb-4">
                            <div class="spinner-border" role="status">
                                <span class="visually-hidden">Finding mosques...</span>
                            </div>
                            <p class="mt-2">Finding nearby mosques...</p>
                        </div>

                        <!-- Location Error -->
                        <div id="mosque-error" class="alert alert-warning d-none" role="alert">
                            <h6 class="alert-heading"><i class="fas fa-exclamation-triangle me-2"></i>Location required</h6>
                            <p class="mb-0">Please allow location access to find nearby mosques.</p>
                        </div>

                        <!-- Mosque List -->
                        <div id="mosque-list" class="d-none">
                            <h5 class="mb-3">Nearby Mosques</h5>
                            <div id="mosques-container">
                                <!-- Mosque items will be populated here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Qibla Finder Section -->
        <section id="qibla" class="section">
            <div class="container">
                <div class="section-header text-center">
                    <h2><i class="fas fa-compass me-3"></i>Qibla Finder</h2>
                    <p class="lead">Find the accurate direction to Mecca</p>
                </div>

                <div class="row justify-content-center">
                    <div class="col-lg-6">
                        <div class="qibla-compass">
                            <h4 class="mb-4">Qibla Direction</h4>
                            <div class="compass-circle">
                                <div class="qibla-arrow" id="qibla-arrow">
                                    <i class="fas fa-location-arrow"></i>
                                </div>
                            </div>
                            <div id="qibla-status" class="mt-3">
                                <p class="mb-1">Calculating direction...</p>
                                <small class="text-muted">Allow location access for accurate direction</small>
                            </div>
                            <div id="qibla-info" class="mt-3 d-none">
                                <p class="mb-1">Direction: <strong id="qibla-degree">--°</strong></p>
                                <small class="text-muted">Point your device towards this direction</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Dhikr Counter Section -->
        <section id="dhikr" class="section">
            <div class="container">
                <div class="section-header text-center">
                    <h2><i class="fas fa-hands me-3"></i>Dhikr Counter</h2>
                    <p class="lead">Digital Tasbih for your daily remembrance of Allah</p>
                </div>

                <div class="row justify-content-center">
                    <div class="col-lg-6">
                        <div class="dhikr-counter">
                            <h4 class="mb-4">Tasbih Counter</h4>
                            <div class="dhikr-count" id="dhikr-count">0</div>
                            <button class="dhikr-button" id="dhikr-btn">
                                <i class="fas fa-plus"></i>
                            </button>
                            <div class="mt-4">
                                <button class="btn btn-gold me-2" id="reset-dhikr">
                                    <i class="fas fa-redo me-2"></i>Reset
                                </button>
                                <div class="mt-3">
                                    <p class="mb-1">Common Dhikr:</p>
                                    <small class="text-muted">
                                        SubhanAllah (33) • Alhamdulillah (33) • Allahu Akbar (34)
                                    </small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- About Section -->
        <section id="about" class="section">
            <div class="container">
                <div class="section-header text-center">
                    <h2><i class="fas fa-info-circle me-3"></i>About</h2>
                    <p class="lead">Learn more about this Islamic companion app</p>
                </div>

                <div class="row justify-content-center">
                    <div class="col-lg-8">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="card-title mb-4">Islamic Prayer Times & Tools</h4>
                                <p class="card-text">
                                    This comprehensive Islamic companion application provides Muslims with essential tools for their daily spiritual practice. Our mission is to help the Muslim community stay connected with their faith through accurate prayer times, mosque locations, and spiritual guidance.
                                </p>
                                
                                <h5 class="mt-4 mb-3">Features:</h5>
                                <ul class="list-unstyled">
                                    <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>Accurate prayer times based on your location</li>
                                    <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>Nearby mosque finder with directions</li>
                                    <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>Qibla direction compass</li>
                                    <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>Digital Tasbih counter</li>
                                    <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>Multiple calculation methods</li>
                                    <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>Responsive design for all devices</li>
                                </ul>

                                <h5 class="mt-4 mb-3">Prayer Time Calculation Methods:</h5>
                                <p class="card-text">
                                    We support multiple internationally recognized calculation methods including ISNA, Muslim World League, and others to ensure accuracy across different regions and scholarly opinions.
                                </p>

                                <div class="text-center mt-4">
                                    <p class="text-muted">
                                        <em>"And establish prayer and give zakah and bow with those who bow."</em><br>
                                        <small>- Quran 2:43</small>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-islamic-green text-white py-4">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <h5><i class="fas fa-mosque me-2"></i>Islamic Prayer Times</h5>
                    <p class="mb-0">Your complete Islamic companion for prayer, mosques, and spiritual guidance.</p>
                </div>
                <div class="col-md-6 text-md-end">
                    <div class="footer-links">
                        <a href="#about">About</a>
                        <a href="#prayer-times">Prayer Times</a>
                        <a href="#mosque-finder">Mosques</a>
                        <a href="#qibla">Qibla</a>
                    </div>
                    <p class="mt-2 mb-0">
                        <small>&copy; 2024 Islamic Prayer Times. Made with ❤️ for the Muslim community.</small>
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap 5 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Leaflet JS for Maps -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <script>
        // Global variables
        let userLocation = { lat: null, lng: null };
        let currentSection = 'landing';
        let prayerTimes = {};
        let nextPrayerInterval;
        let dhikrCount = 0;
        let mosqueMap;
        let is24HourFormat = true;
        let currentCalculationMethod = 2;
        let prayerTimesInitialized = false;
        let mosqueFinderInitialized = false;
        let qiblaInitialized = false;

        // Initialize app when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        // Initialize the application
        function initializeApp() {
            // Handle initial page load and routing
            handleRouting();
            
            // Set up navigation event listeners
            setupNavigation();
            
            // Set up other event listeners
            setupEventListeners();
        }

        // Fixed routing function to handle page refresh correctly
        function handleRouting() {
            const hash = window.location.hash.substring(1) || 'landing';
            
            // Update current section
            currentSection = hash;
            
            // Show the correct section
            showSection(hash);
            
            // Update navbar highlighting
            updateNavbarHighlight(hash);
        }

        // Setup navigation event listeners
        function setupNavigation() {
            // Handle hash changes (back/forward buttons)
            window.addEventListener('hashchange', handleRouting);
            
            // Handle navigation clicks
            document.querySelectorAll('[data-section]').forEach(element => {
                element.addEventListener('click', function(e) {
                    e.preventDefault();
                    const section = this.getAttribute('data-section');
                    navigateToSection(section);
                });
            });
        }

        // Navigate to a specific section
        function navigateToSection(sectionId) {
            // Update URL hash
            window.location.hash = sectionId;
            
            // Don't need to call showSection here as hashchange event will handle it
        }

        // Show specific section with proper initialization
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Show target section
            const targetSection = document.getElementById(sectionId);
            if (targetSection) {
                targetSection.classList.add('active');
                currentSection = sectionId;
                
                // Initialize section-specific functionality
                initializeSectionFeatures(sectionId);
            }
        }

        // Fixed navbar highlighting function
        function updateNavbarHighlight(activeSection) {
            // Remove active class from all nav links
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            // Add active class to current section's nav link
            const activeLink = document.querySelector(`[data-section="${activeSection}"]`);
            if (activeLink) {
                activeLink.classList.add('active');
            }
        }

        // Initialize section-specific features to prevent infinite loading
        function initializeSectionFeatures(sectionId) {
            switch(sectionId) {
                case 'landing':
                    // Initialize landing page features if needed
                    break;
                    
                case 'prayer-times':
                    if (!prayerTimesInitialized) {
                        initializePrayerTimes();
                        prayerTimesInitialized = true;
                    }
                    break;
                    
                case 'mosque-finder':
                    if (!mosqueFinderInitialized) {
                        initializeMosqueFinder();
                        mosqueFinderInitialized = true;
                    }
                    break;
                    
                case 'qibla':
                    if (!qiblaInitialized) {
                        initializeQiblaFinder();
                        qiblaInitialized = true;
                    }
                    break;
                    
                case 'dhikr':
                    // Dhikr counter doesn't need special initialization
                    break;
                    
                case 'about':
                    // About page doesn't need special initialization
                    break;
            }
        }

        // Setup other event listeners
        function setupEventListeners() {
            // Dhikr counter
            const dhikrBtn = document.getElementById('dhikr-btn');
            const resetDhikrBtn = document.getElementById('reset-dhikr');
            const dhikrCountDisplay = document.getElementById('dhikr-count');

            if (dhikrBtn) {
                dhikrBtn.addEventListener('click', function() {
                    dhikrCount++;
                    dhikrCountDisplay.textContent = dhikrCount;
                    
                    // Add click effect
                    this.style.transform = 'scale(0.95)';
                    setTimeout(() => {
                        this.style.transform = 'scale(1)';
                    }, 150);
                });
            }

            if (resetDhikrBtn) {
                resetDhikrBtn.addEventListener('click', function() {
                    dhikrCount = 0;
                    dhikrCountDisplay.textContent = dhikrCount;
                });
            }

            // Time format toggle
            const timeFormatSwitch = document.getElementById('timeFormatSwitch');
            if (timeFormatSwitch) {
                timeFormatSwitch.addEventListener('change', function() {
                    is24HourFormat = this.checked;
                    updateTimeFormatLabel();
                    if (Object.keys(prayerTimes).length > 0) {
                        displayPrayerTimes(prayerTimes);
                    }
                });
            }

            // Calculation method change
            const methodSelect = document.getElementById('methodSelect');
            if (methodSelect) {
                methodSelect.addEventListener('change', function() {
                    currentCalculationMethod = parseInt(this.value);
                    if (userLocation.lat && userLocation.lng) {
                        fetchPrayerTimes(userLocation.lat, userLocation.lng);
                    }
                });
            }
        }

        // Initialize Prayer Times
        function initializePrayerTimes() {
            getUserLocation()
                .then(location => {
                    userLocation = location;
                    return fetchPrayerTimes(location.lat, location.lng);
                })
                .then(times => {
                    prayerTimes = times;
                    displayPrayerTimes(times);
                    hideLoadingShowContent('prayer');
                    startNextPrayerCountdown();
                })
                .catch(error => {
                    console.error('Error getting prayer times:', error);
                    showError('prayer', 'Unable to load prayer times. Please check your internet connection and location settings.');
                });
        }

        // Initialize Mosque Finder
        function initializeMosqueFinder() {
            // Show the map container first
            const mapContainer = document.getElementById('mosque-map');
            if (mapContainer) {
                getUserLocation()
                    .then(location => {
                        userLocation = location;
                        initializeMosqueMap(location);
                        return findNearbyMosques(location.lat, location.lng);
                    })
                    .then(mosques => {
                        displayMosqueList(mosques);
                        hideLoadingShowContent('mosque');
                    })
                    .catch(error => {
                        console.error('Error finding mosques:', error);
                        showError('mosque', 'Unable to find nearby mosques. Please check your location settings.');
                    });
            }
        }

        // Initialize Qibla Finder
        function initializeQiblaFinder() {
            getUserLocation()
                .then(location => {
                    calculateQiblaDirection(location.lat, location.lng);
                })
                .catch(error => {
                    console.error('Error getting location for Qibla:', error);
                    document.getElementById('qibla-status').innerHTML = 
                        '<p class="text-warning">Please allow location access to find Qibla direction</p>';
                });
        }

        // Get user location
        function getUserLocation() {
            return new Promise((resolve, reject) => {
                if (!navigator.geolocation) {
                    reject(new Error('Geolocation is not supported'));
                    return;
                }

                navigator.geolocation.getCurrentPosition(
                    position => {
                        resolve({
                            lat: position.coords.latitude,
                            lng: position.coords.longitude
                        });
                    },
                    error => {
                        reject(error);
                    },
                    {
                        enableHighAccuracy: true,
                        timeout: 10000,
                        maximumAge: 600000 // 10 minutes
                    }
                );
            });
        }

        // Fetch prayer times from API
        function fetchPrayerTimes(lat, lng) {
            return new Promise((resolve, reject) => {
                const today = new Date();
                const dateString = today.getFullYear() + '-' + 
                    String(today.getMonth() + 1).padStart(2, '0') + '-' + 
                    String(today.getDate()).padStart(2, '0');

                const apiUrl = `https://api.aladhan.com/v1/timings/${dateString}?latitude=${lat}&longitude=${lng}&method=${currentCalculationMethod}`;

                fetch(apiUrl)
                    .then(response => response.json())
                    .then(data => {
                        if (data.code === 200) {
                            resolve(data.data.timings);
                            // Also update location info
                            updateLocationInfo(data.data.meta);
                        } else {
                            reject(new Error('API returned error'));
                        }
                    })
                    .catch(error => {
                        reject(error);
                    });
            });
        }

        // Display prayer times
        function displayPrayerTimes(times) {
            const prayers = ['Fajr', 'Dhuhr', 'Asr', 'Maghrib', 'Isha', 'Sunrise'];
            
            prayers.forEach(prayer => {
                const timeElement = document.getElementById(prayer.toLowerCase() + '-time');
                if (timeElement && times[prayer]) {
                    timeElement.textContent = formatTime(times[prayer]);
                }
            });

            // Highlight current prayer
            highlightCurrentPrayer(times);
        }

        // Format time based on user preference
        function formatTime(timeString) {
            const [hours, minutes] = timeString.split(':');
            
            if (is24HourFormat) {
                return `${hours}:${minutes}`;
            } else {
                const hour12 = hours % 12 || 12;
                const ampm = hours >= 12 ? 'PM' : 'AM';
                return `${hour12}:${minutes} ${ampm}`;
            }
        }

        // Update time format label
        function updateTimeFormatLabel() {
            const label = document.getElementById('timeFormatLabel');
            if (label) {
                label.textContent = is24HourFormat ? '24-hour format' : '12-hour format';
            }
        }

        // Highlight current prayer
        function highlightCurrentPrayer(times) {
            const now = new Date();
            const currentTime = now.getHours() * 60 + now.getMinutes();
            
            const prayers = ['Fajr', 'Dhuhr', 'Asr', 'Maghrib', 'Isha'];
            let currentPrayer = null;

            // Remove all highlights first
            prayers.forEach(prayer => {
                const card = document.getElementById(prayer.toLowerCase() + '-card');
                if (card) {
                    card.classList.remove('current-prayer');
                }
            });

            // Find and highlight current prayer
            for (let i = 0; i < prayers.length; i++) {
                const prayer = prayers[i];
                const prayerTime = parseTime(times[prayer]);
                const nextPrayer = prayers[i + 1];
                const nextPrayerTime = nextPrayer ? parseTime(times[nextPrayer]) : parseTime(times['Fajr']) + 24 * 60;

                if (currentTime >= prayerTime && currentTime < nextPrayerTime) {
                    currentPrayer = prayer;
                    break;
                }
            }

            if (currentPrayer) {
                const card = document.getElementById(currentPrayer.toLowerCase() + '-card');
                if (card) {
                    card.classList.add('current-prayer');
                }
            }
        }

        // Parse time string to minutes
        function parseTime(timeString) {
            const [hours, minutes] = timeString.split(':').map(Number);
            return hours * 60 + minutes;
        }

        // Start next prayer countdown
        function startNextPrayerCountdown() {
            if (nextPrayerInterval) {
                clearInterval(nextPrayerInterval);
            }

            nextPrayerInterval = setInterval(() => {
                updateNextPrayerCountdown();
            }, 1000);

            updateNextPrayerCountdown();
        }

        // Update next prayer countdown
        function updateNextPrayerCountdown() {
            if (!prayerTimes || Object.keys(prayerTimes).length === 0) return;

            const now = new Date();
            const prayers = ['Fajr', 'Dhuhr', 'Asr', 'Maghrib', 'Isha'];
            let nextPrayer = null;
            let nextPrayerTime = null;

            for (let prayer of prayers) {
                const prayerTime = new Date();
                const [hours, minutes] = prayerTimes[prayer].split(':');
                prayerTime.setHours(parseInt(hours), parseInt(minutes), 0, 0);

                if (prayerTime > now) {
                    nextPrayer = prayer;
                    nextPrayerTime = prayerTime;
                    break;
                }
            }

            // If no prayer found for today, next is Fajr tomorrow
            if (!nextPrayer) {
                nextPrayer = 'Fajr';
                nextPrayerTime = new Date();
                const [hours, minutes] = prayerTimes['Fajr'].split(':');
                nextPrayerTime.setDate(nextPrayerTime.getDate() + 1);
                nextPrayerTime.setHours(parseInt(hours), parseInt(minutes), 0, 0);
            }

            const timeDiff = nextPrayerTime - now;
            const hours = Math.floor(timeDiff / (1000 * 60 * 60));
            const minutes = Math.floor((timeDiff % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((timeDiff % (1000 * 60)) / 1000);

            const nextPrayerSection = document.getElementById('next-prayer-section');
            const nextPrayerName = document.getElementById('next-prayer-name');
            const countdownTimer = document.getElementById('countdown-timer');

            if (nextPrayerSection && nextPrayerName && countdownTimer) {
                nextPrayerSection.classList.remove('d-none');
                nextPrayerName.textContent = nextPrayer;
                countdownTimer.textContent = 
                    `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
            }
        }

        // Update location information
        function updateLocationInfo(meta) {
            const cityElement = document.getElementById('prayer-city');
            const countryElement = document.getElementById('prayer-country');
            const coordinatesElement = document.getElementById('prayer-coordinates');

            if (cityElement && meta.city) cityElement.textContent = meta.city;
            if (countryElement && meta.country) countryElement.textContent = meta.country;
            if (coordinatesElement && userLocation.lat && userLocation.lng) {
                coordinatesElement.textContent = `${userLocation.lat.toFixed(4)}, ${userLocation.lng.toFixed(4)}`;
            }
        }

        // Initialize mosque map
        function initializeMosqueMap(location) {
            if (mosqueMap) {
                mosqueMap.remove();
            }

            mosqueMap = L.map('mosque-map').setView([location.lat, location.lng], 13);

            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '© OpenStreetMap contributors'
            }).addTo(mosqueMap);

            // Add user location marker
            L.marker([location.lat, location.lng])
                .addTo(mosqueMap)
                .bindPopup('Your Location')
                .openPopup();
        }

        // Find nearby mosques (mock function - replace with real API)
        function findNearbyMosques(lat, lng) {
            return new Promise((resolve) => {
                // Mock mosque data - replace with real API call
                setTimeout(() => {
                    const mockMosques = [
                        {
                            name: "Central Mosque",
                            address: "123 Main Street, City Center",
                            distance: "0.5 km",
                            lat: lat + 0.005,
                            lng: lng + 0.005
                        },
                        {
                            name: "Islamic Center",
                            address: "456 Oak Avenue, Downtown",
                            distance: "1.2 km",
                            lat: lat - 0.008,
                            lng: lng + 0.008
                        },
                        {
                            name: "Community Mosque",
                            address: "789 Pine Road, Suburb",
                            distance: "2.1 km",
                            lat: lat + 0.012,
                            lng: lng - 0.009
                        }
                    ];
                    resolve(mockMosques);
                }, 1000);
            });
        }

        // Display mosque list
        function displayMosqueList(mosques) {
            const container = document.getElementById('mosques-container');
            if (!container) return;

            container.innerHTML = '';

            mosques.forEach((mosque, index) => {
                const mosqueItem = document.createElement('div');
                mosqueItem.className = 'mosque-item';
                mosqueItem.innerHTML = `
                    <div class="d-flex justify-content-between align-items-start">
                        <div>
                            <div class="mosque-name">${mosque.name}</div>
                            <div class="mosque-address">${mosque.address}</div>
                        </div>
                        <span class="distance-badge">${mosque.distance}</span>
                    </div>
                `;

                mosqueItem.addEventListener('click', () => {
                    if (mosqueMap) {
                        mosqueMap.setView([mosque.lat, mosque.lng], 16);
                    }
                });

                container.appendChild(mosqueItem);

                // Add mosque marker to map
                if (mosqueMap) {
                    L.marker([mosque.lat, mosque.lng])
                        .addTo(mosqueMap)
                        .bindPopup(`<strong>${mosque.name}</strong><br>${mosque.address}`);
                }
            });
        }

        // Calculate Qibla direction
        function calculateQiblaDirection(lat, lng) {
            // Mecca coordinates
            const meccaLat = 21.4225;
            const meccaLng = 39.8262;

            // Calculate bearing to Mecca
            const dLng = (meccaLng - lng) * Math.PI / 180;
            const lat1 = lat * Math.PI / 180;
            const lat2 = meccaLat * Math.PI / 180;

            const y = Math.sin(dLng) * Math.cos(lat2);
            const x = Math.cos(lat1) * Math.sin(lat2) - Math.sin(lat1) * Math.cos(lat2) * Math.cos(dLng);

            let bearing = Math.atan2(y, x) * 180 / Math.PI;
            bearing = (bearing + 360) % 360;

            // Update Qibla display
            const qiblaArrow = document.getElementById('qibla-arrow');
            const qiblaStatus = document.getElementById('qibla-status');
            const qiblaInfo = document.getElementById('qibla-info');
            const qiblaDegree = document.getElementById('qibla-degree');

            if (qiblaArrow) {
                qiblaArrow.style.transform = `rotate(${bearing}deg)`;
            }

            if (qiblaStatus) {
                qiblaStatus.classList.add('d-none');
            }

            if (qiblaInfo && qiblaDegree) {
                qiblaInfo.classList.remove('d-none');
                qiblaDegree.textContent = `${Math.round(bearing)}°`;
            }
        }

        // Hide loading and show content
        function hideLoadingShowContent(section) {
            const loadingElement = document.getElementById(`${section}-loading`);
            const errorElement = document.getElementById(`${section}-error`);

            if (loadingElement) {
                loadingElement.classList.add('d-none');
            }

            if (errorElement) {
                errorElement.classList.add('d-none');
            }

            // Show section-specific content
            if (section === 'prayer') {
                ['calculation-method', 'prayer-location-card', 'prayer-format-toggle', 'prayer-times-grid'].forEach(id => {
                    const element = document.getElementById(id);
                    if (element) {
                        element.classList.remove('d-none');
                    }
                });
            } else if (section === 'mosque') {
                const mosqueList = document.getElementById('mosque-list');
                if (mosqueList) {
                    mosqueList.classList.remove('d-none');
                }
            }
        }

        // Show error message
        function showError(section, message) {
            const loadingElement = document.getElementById(`${section}-loading`);
            const errorElement = document.getElementById(`${section}-error`);

            if (loadingElement) {
                loadingElement.classList.add('d-none');
            }

            if (errorElement) {
                errorElement.classList.remove('d-none');
                // Update error message if needed
                const messageElement = errorElement.querySelector('p');
                if (messageElement && message) {
                    messageElement.textContent = message;
                }
            }
        }
    </script>
</body>
</html>
